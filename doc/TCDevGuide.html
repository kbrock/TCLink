<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>


	<meta http-equiv="CONTENT-TYPE" content="text/html; charset=utf-8"><title>TrustCommerce Developer's Guide v2.5</title></head><body dir="ltr" bgcolor="#ffffff" lang="en-US" link="#0000ff" text="#000000" vlink="#00008b">

<hr> 

<h1>TrustCommerce Developer's Guide 2.5 </h1>

<p> <a href="http://www.trustcommerce.com/">http://www.trustcommerce.com</a> <br>
    <a href="mailto:developer@trustcommerce.com">developer@trustcommerce.com</a> 

</p><hr> 

<h2>Table of Contents </h2>

<table>
	<tbody><tr><td><a href="#intro">I. Introduction </a></td></tr>
	<tr><td><a href="#tclink">II. Connecting via TCLink </a></td></tr>
	<tr><td><a href="#transtypes">III. Transaction Types </a></td></tr>
	<tr><td><a href="#inputparam">IV. Input Parameters </a></td></tr>
	<tr><td><a href="#returnparam">V. Return Parameters </a></td></tr>
	<tr><td><a href="#sales">VI. Credit Card Preauths and Sales </a></td></tr>
	<tr><td><a href="#cvv">VII. Card Verification Value (CVV) </a></td></tr>
	<tr><td><a href="#cardpresent">VIII. Card-Present Transactions </a></td></tr>
	<tr><td><a href="#ach">IX. ACH </a></td></tr>
	<tr><td><a href="#credits">X. Postauths, Credits, and Chargebacks </a></td></tr>
	<tr><td><a href="#billingids">XI. Citadel (Billing IDs) </a></td></tr>
	<tr><td><a href="#recurring">XII. Recurring Billing </a></td></tr>
	<tr><td><a href="#wallet">XIII. TC Wallet </a></td></tr>
	<tr><td><a href="#crediguard-neural">XIV. CrediGuard - Neural Network Fraud Scoring</a></td></tr>
	<tr><td><a href="#crediguard-blacklist">XV. CrediGuard - Blacklists</a></td></tr>
	<tr><td><a href="#crediguard-velocity">XVI. CrediGuard - Velocity Control</a></td></tr>
	<tr><td><a href="#pl2">XVII. Purchase Level II (Commercial Cards) </a></td></tr>
	<tr><td><a href="#orderdetail">XVIII. Automated Fulfillment </a></td></tr>
	<tr><td><a href="#batchProcessing">XIX. Batch Processing </a></td></tr>
	<tr><td><a href="#query">XX. Vault Query API </a></td></tr>
	<tr><td><a href="#testdata">Appendix A - Test Data </a></td></tr>
	<tr><td><a href="#troubleshooting">Appendix B - Troubleshooting </a></td></tr>
	<tr><td><a href="#httpspost">Appendix C - Connecting via HTTPS POST </a></td></tr>
	<tr><td><a href="#currency">Appendix D - Currency Table </a></td></tr>
	<tr><td><a href="#inputfields">Appendix E - Input Field List </a></td></tr>
</tbody></table>

<hr>

<h2><a name="intro"></a>I. Introduction </h2>

<p>
This guide is for developers. If you are seeking to add payment
processing functionality to a software package or website using the
TrustCommerce, platform and language neutral, transaction processing
API, then this guide is for you. If you are connecting via a
pre-integrated commerce package, including shopping carts such as
StoreForge, Mal's e-Commerce, or osCommerce, then you do not need this
document. </p><p>
An overview of payment processing and information about the
TrustCommerce Vault website are presented in the TrustCommerce User's
Guide and will not be covered here. If you are not familiar with the
basics of credit card processing (such as the difference between an
auth and capture), then you should probably read the User's Guide
first. The User's Guide also describes the Vault's reporting
capabilities, which you may find useful to confirm that your test
transactions are working as expected.
</p><p>There are two methods of connecting to the TrustCommerce
gateway at the programming level: TCLink client software and HTTPS POST
to the Vault server. TCLink is HIGHLY recommend, as it offers support
for TrustCommerce's advanced features such as automated failover,
2048-bit encryption and server certificate verification. It's available
for many platforms and languages, and installation is straightforward.
If you are unable to use TCLink, the HTTPS POST method will still allow
you to access most features of the TrustCommerce processing engine, but
be aware that it cannot match the speed and especially the reliability
of TCLink. </p><h2><a name="tclink"></a>II. Connecting via TCLink </h2>

<p>
The TCLink API is available for download from the Vault website. Be
sure to choose the version that matches the platform and language that
you are using. Win32 developers will typically want the COM object,
which contains support for a number of different languages on the Win32
platform, including ASP, Cold Fusion, Perl, PHP, and Python. </p><p>
Installation instructions specific to the TCLink version you download
can be found in the readme file contained within the archive. It will
also contain a version of the TCTest program specific to the language
you are using. Review this example, and use it as the basis for your
own code. In fact, we recommend that you look over the code sample now
to get a feel for the API, and then return to reading this document. </p><p>
Versions of TCLink for high-level languages (including PHP, Perl,
Python, and Java) with built in support for hashes only have one
method: Send(). This method accepts a single parameter, a hash of input
values, and returns a single parameter, a hash of output values. The
only other method available is GetVersion(), which returns the version
string for TCLink. </p><p>
TCLink for other languages (including C/C++, Win32 COM, and CFX)
contains four basic methods: Create(), PushParam(), Send(), and
GetResponse(). These four methods map to the four stages of running a
transaction: initialize, push a number of parameters describing the
transaction, send the transaction to the TrustCommerce gateway for
processing, and finally get details about the transaction results. </p><p>
The only method which contacts the TC servers is Send(). This function
will block for one or two seconds while the transaction is processed.
Afterward, you can retrieve response parameters at your leisure; they
are stored internally in TCLink. </p><p>
C-style TCLink functions are described in the table below. 

</p><p>
</p><h3 align="center">TCLink Function Names  </h3>

<center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Function Name </th><th>Description</th></tr>
		<tr><td>CreateLink()</td><td>Create a new transaction handle.</td></tr>
		<tr><td>PushParam()</td><td>Push a parameter into the transaction.</td></tr>
		<tr><td>Send()</td><td>Submit a transaction to the gateway.</td></tr>
		<tr><td>GetResponse()</td><td>Retrieve a response parameter from the transaction. </td></tr>
		<tr><td>GetEntireResponse()</td><td>Get the entire response for the transaction, primarily use for debugging or logging.</td></tr>
		<tr><td>Destroy()</td><td>Deallocate any memory associated with the transaction handle.</td></tr>
		<tr><td>GetVersion()</td><td>Get the version string for the TCLink API in use.</td></tr>
	</tbody></table>
</center>

<p>
</p><h2><a name="transtypes"></a>III. Transaction Types </h2>

<p>
You may wish to read the section of the TC User's Guide which describes
the transaction types and the authorization/capture process, especially
if you are not already familiar with credit card processing. </p><p>
In terms of parameters passed, preauths and sales are almost identical.
They take account data and personal information about the customer,
along with a transaction amount. The transaction is authorized and the
response values returned. In the case of a sale, the item is also
immediately submitted for capture. Preauths are not captured until they
are postauthed. </p><p>
Postauths and credits are also very similar to one another. They
indicate a capture or a return of funds for a previous transaction, and
no personal data about the customer or their payment method is passed. </p><p>
There are three other types of transaction. Store and unstore are covered in the <a href="#billingids">Billing ID section </a>of this document. Walletsale is covered under the <a href="#wallet">TC Wallet section </a>. 

</p><p>
</p><h2><a name="inputparam"></a>IV. Input Parameters </h2>

<p>
There are a large number of parameters available for describing
transactions. Not all parameters are accepted for all transaction
types, and most parameters are optional. Most transactions can be sent
with only a few parameters. The only parameters always required are
custid, password, and action. </p><p>
Parameters are carefully checked for format and size before the
transaction is sent. If there are any errors in the parameters you've
entered, the transaction will be aborted and detailed information about
the errors will be returned. These return values are described in more
detail in the next section. </p><p>
All transaction types use the parameters presented in the following tables.  

</p><p> 
</p><h3 align="center">Required Parameters</h3>

<p>
</p><center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Parameter Name</th><th>Description</th></tr>
		<tr><td>amount</td><td>Amount of the transaction, in cents. (example: "500" is $5.00) </td></tr>
		<tr><td>custid</td><td>The customer ID number assigned to you by TrustCommerce.</td></tr>
		<tr><td>password</td><td>The password for your custid as assigned by TrustCommerce. </td></tr>
		<tr><td>action</td><td>The transaction type; can be one of preauth, sale, postauth,credit, store, unstore, walletsale, or chargeback </td></tr>
	</tbody></table>
</center>

<p>
</p><h3 align="center">Optional Parameters </h3>

<center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="3">
		<tbody><tr><th>Parameter Name </th><th>Description </th></tr>
		<tr><td>demo </td><td>When set to "y", the transaction will be a test transaction only. 
			<p>This
parameter is useful for testing. Demo transactions allow you to submit
transactions from your processing system without charging real money to
a card and without incurring any transaction fees. Demo transactions
are also flagged separately in the Vault database and will not appear
in the regular accounting reports. </p></td></tr>
		<tr><td>ticket</td><td>Free-form
text field intended for storing ticket number or order number
associated with the transaction, to aid merchants in order tracking and
reporting. <p>The ticket parameter is passed to the acquiring bank in the
settlement process as the "purchase identifier." This may aid in
reconciling the TrustCommerce transactions with the deposits made into
the merchant bank account. If no ticket is passed, then the
TrustCommerce transID will be sent to the bank instead. </p></td></tr>
		<tr><td>operator</td><td>Free-form
text field intended for recording the operator that entered the
transaction, to aid merchants in order track and reporting.
Enterprise-class customers will note that this field corresponds to the
username assigned to operators in the Vault.</td></tr>
	</tbody></table>
</center>
<p>
</p><h2><a name="returnparam"></a>V. Return Parameters </h2>

<p>
Any transaction sent will return several parameters describing the
success or failure of the transaction. Properly formatted transactions
will always return a transaction ID (or "transID".) The transaction ID
is the unique identifier for this transaction, and can be used to
retrieve the transaction from the Vault website, or otherwise access
the transaction in the future. (For example, in order to credit a
previous transaction, you will need to send the transID of the original
transaction.) </p><p>
Transactions always return a status parameter which describes the
success or failure of the transaction. Status can be set to one of the
following: </p><h3 align="center"><a name="Status|outline"></a>Status </h3>
<center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="3">
		<tbody><tr><th>Status Value </th><th>Description </th></tr>
		<tr><td>approved </td><td>The transaction was successfully authorized. </td></tr>
		<tr><td>accepted </td><td>The transaction has been successfully accepted into the system. </td></tr>
		<tr><td>decline </td><td>The transaction was declined, see declinetype for further details. </td></tr>
		<tr><td>baddata </td><td>Invalid parameters passed, see error for further details.  </td></tr>
		<tr><td>error </td><td>System error when processing the transaction, see errortype for details.  </td></tr>
	</tbody></table>
</center>

<p>
The difference between approved and accepted is subtle, but important.
Approved means that the transaction was an authorization of some sort,
and has been successfully cleared with the bank. Accepted only means
that the transaction was queued into the system without errors, but may
be rejected at some later time. An example of the difference is a sale
versus a credit. A sale is a real-time authorization, so it returns
approved on success. A credit is not real-time; there is no such thing
as a "credit authorization." Instead it is queued up for processing by
the bank and there is the small but non-zero possibility that it will
be rejected at a later time. In practice, however, this rarely happens,
so the developer need not worry unduly. </p><p>
When status is set to decline, the parameter declinetype will contain one of the following: 

</p><p>
</p><h3 align="center"><a name="Decline Type|outline"></a>Decline Type </h3>
<center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Declinetype Value </th><th>Description </th></tr>
		<tr><td>decline </td><td>This is a "true" decline, it almost always is a result of insufficient funds on the card.</td></tr>
		<tr><td>avs </td><td>AVS failed; the address entered does not match the billing address on file at the bank. </td></tr>
		<tr><td>cvv </td><td>CVV failed; the number provided is not the correct	verification number for the card. (See <a href="#cvv">CVV section </a>for more details.)  </td></tr>
		<tr><td>call </td><td>The
card must be authorized manually over the phone. You may choose to call
the customer service number listed on the card and ask for an offline
authcode, which can be passed in the offlineauthcode field. </td></tr>
		<tr><td>expiredcard </td><td>The card has expired.  Get updated expiration date from cardholder.</td></tr>
		<tr><td>carderror </td><td>Card number is invalid, which could be a typo, or sometimes a card reported stolen. </td></tr>
		<tr><td>authexpired </td><td>Attempt to postauth an expired (more than 14 days old) preauth.  </td></tr>
		<tr><td>fraud </td><td><a href="#crediguard-neural">CrediGuard fraud score</a> was below requested thershold.</td></tr>
		<tr><td>blacklist </td><td><a href="#crediguard-blacklist">CrediGuard blacklist</a> value was triggered.</td></tr>
		<tr><td>velocity </td><td><a href="#crediguard-velocity">CrediGuard velocity control</a> was triggered.</td></tr>
		<tr><td>dailylimit </td><td>Daily limit in transaction count or amount as been reached. </td></tr>
		<tr><td>weeklylimit </td><td>Weekly limit in transaction count or amount as been reached. </td></tr>
		<tr><td>monthlylimit </td><td>Monthly limit in transaction count or amount as been reached. </td></tr>
	</tbody></table>
</center>

<p>
A status of baddata indicates that no transaction was attempted because
one or more parameters was invalid. In this case, the parameter error
will indicate the problem, and the offender's parameter will list the
offending input fields. The error parameter may be set to one of the
following: </p><p>
</p><h3 align="center"><a name="Bad Data|outline"></a>Bad Data </h3>
<center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Error Value </th><th>Description </th></tr>
		<tr><td>missingfields </td><td>One or more parameters required for this transaction type were not sent.  </td></tr>
		<tr><td>extrafields </td><td>Parameters not allowed for this transaction type were sent.  </td></tr>
		<tr><td>badformat </td><td>A field was improperly formatted, such as non-digit characters in a number field.  </td></tr>
		<tr><td>badlength </td><td>A field was longer or shorter than the server allows. </td></tr>
		<tr><td>merchantcantaccept </td><td>The
merchant can't accept data passed in this field. If the offender is
"cc", for example, it usually means that you tried to run a card type
(such as American Express or Discover) that is not supported by your
account. If it was "currency", you tried to run a currency type not
supported by your account. </td></tr>
		<tr><td>mismatch </td><td>Data in one of the offending fields did not cross-check with the other offending field.  </td></tr>
	</tbody></table>
</center>

<p>
A status of error indicates the an error occurred while processing the
transaction. These are almost always networking errors; see the <a href="#troubleshooting">Troubleshooting section </a>for more details. If the status is error, then the errortype parameter will be set to one of the following: 

</p><p>
</p><h3 align="center"><a name="Errortype|outline"></a><a name="Errortype|outline"></a>Errortype </h3>

<center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Errortype Value </th><th>Description </th></tr>
		<tr><td>cantconnect </td><td>Couldn't connect to the TrustCommerce gateway. Check your Internet connection to make sure it is up.  </td></tr>
		<tr><td>dnsfailure </td><td>The TCLink software was unable to resolve DNS hostnames. Make sure you have name resolving ability on the machine.  </td></tr>
		<tr><td>linkfailure </td><td>The connection was established, but was severed before the transaction could complete.  </td></tr>
		<tr><td>failtoprocess </td><td>The
bank servers are offline and unable to authorize transactions. Try
again in a few minutes, or try a card from a different issuing bank. </td></tr>
	</tbody></table>
</center>

<p>
Other parameters (such as avs or billingid) may be returned by the
transaction depending on the action; see sections covering the
transaction type you're running for detailed information on the
specialized return values. </p><p>
</p><h2><a name="sales"></a><a name="VI. Credit Card Preauths and Sales|outline"></a> VI. Credit Card Preauths and Sales </h2>

<p>
The 'preauth' and 'sale' actions are identical in terms of parameters
and function. The only difference is that a sale submits the item for
capture as well, while preauths run the authorization only and can be
postauthed at another time. </p><p>
The parameters that can be passed with these action types are described
in the following two tables. The first table list required fields that
you must pass in order to send the transaction. The second table lists
optional fields that you can pass if you wish, but are not required. </p><p>
</p><h3 align="center">Required Parameters  </h3>
<center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="3">
		<tbody><tr><th>Parameter Name 	</th><th>Description </th></tr>
		<tr><td>amount </td><td>Amount of the transaction, in cents. (example: "500" is $5.00)</td></tr>
		<tr><td>cc </td><td>Credit card number, digits only (no spaces or dashes) </td></tr>
		<tr><td>exp </td><td>Credit card expiration date, in MMYY format. </td></tr>
	</tbody></table>
</center>

<p>
</p><h3 align="center">Optional Parameters </h3>
<center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="3">
		<tbody><tr><th>Parameter Name </th><th>Default Value </th><th>Description </th></tr>
		<tr><td>media </td><td>cc </td><td>"cc" for credit card or "ach" for ACH.  </td></tr>
		<tr><td>currency </td><td>usd </td><td>Currency code (see the <a href="#currency">Currency Table </a>for a list of allowed codes.)  </td></tr>
		<tr><td>avs </td><td>n </td><td>AVS requested, "y" or "n".  
			<p>NOTE:<br>The
AVS system is a useful way to help screen for fraud. Unfortunately,
card issuers do not provide uniform support for AVS; approximately 30%
of US-based credit cards do not have AVS capability, and AVS is not
available with any non-US cards at all. The ONLY time that a
transaction will be declined due to AVS is in cases where AVS is
available and the address data submitted with the transaction does not
match the data on file at the bank. If AVS is unavailable, it will not
cause the transaction to fail. For this reason, you may wish to screen
AVS results closely. </p><p>Only the numeric parts of the address (street address and
zip code) are verified. It should also be noted that on occasion, AVS
data is incorrect or not entirely up-to-date. Treat AVS as a helpful
tool which can be used in combination with other methods (dependent
upon your business model) for screening transactions. If you trust AVS
too blindly, you may risk losing legitimate sales. Some merchants
(again, dependent upon business model) choose to turn AVS off
altogether. You should analyze your customer base and make the decision
that will work best for your business. </p></td></tr>
		<tr><td>name </td><td><br></td><td>Cardholder's name. </td></tr>
		<tr><td>address1 </td><td><br></td><td>First line of cardholder's street address. </td></tr>
		<tr><td>address2 </td><td><br></td><td>Second line of cardholder's street address. </td></tr>
		<tr><td>city </td><td><br></td><td>Cardholder's city. </td></tr>
		<tr><td>state </td><td><br></td><td>Two-character code for the cardholder's state, or the full region/province for international addresses.  </td></tr>
		<tr><td>zip </td><td><br></td><td>Cardholder's zip code, five or nine digits with no spaces or dashes, or the full postal code for international addresses.  </td></tr>
		<tr><td>country </td><td><br></td><td>Cardholder's country, leave blank for US.  </td></tr>
		<tr><td>phone </td><td><br></td><td>Cardholder's phone number. </td></tr>
		<tr><td>email </td><td><br></td><td>Cardholder's email address. </td></tr>
		<tr><td>ip </td><td><br></td><td>Customer's
originating TCP/IP address (e-commerce only). This is not your server's
IP, but that of the customer's computer, as reported by the web server.
For example, in PHP the global variable $_SERVER{'REMOTE_ADDR'}
contains the incoming IP address which should be passed in this field.</td></tr>
		<tr><td>offlineauthcode </td><td><br></td><td>Six-digit numeric code used to "force" the transaction.  
			<p>NOTE: 
			</p><p>Some
cards returned a declinetype of call. This indicates that the card
cannot be automatically authorized. If you call the card issuer, they
may be able to give you a manual authorization, which will consist of a
six-digit auth code. You may then push the transaction through by
entering that code into the offlineauthcode field. Offline
authorizations via offlineauthcode can only be used with sale
transactions. Since offlineauthcode skips the authorization phase
altogether, it is not guaranteed in the same way as a normal
authorization. Be careful with the use of this parameter. </p></td></tr>
	</tbody></table>
</center>

<p>
</p><h3 align="center">AVS Returns Codes </h3>

<center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="3">
		<tbody><tr><th>Code </th><th>Description </th></tr>
		<tr><td><p align="center">X </p></td><td>Exact match, 9 digit zip code. </td></tr>
		<tr><td><p align="center">Y</p></td><td>Exact match, 5 digit zip code. </td></tr>
		<tr><td><p align="center">A </p></td><td>Street address match only. </td></tr>
		<tr><td><p align="center">W </p></td><td>9 digit zip code match only. </td></tr>
		<tr><td><p align="center">Z </p></td><td>5 digit zip code match only. </td></tr>
		<tr><td><p align="center">N </p></td><td>No match on street address or zip code. </td></tr>
		<tr><td><p align="center">U </p></td><td>AVS unavailable on this card. </td></tr>
		<tr><td><p align="center">G </p></td><td>Non-US card issuer, AVS unavailable. </td></tr>
		<tr><td><p align="center">R </p></td><td>Card issuer system currently down, try again later. </td></tr>
		<tr><td><p align="center">E </p></td><td>Error, ineligible - not a mail/phone order. </td></tr>
		<tr><td><p align="center">S </p></td><td>Service not supported. </td></tr>
		<tr><td><p align="center">0 </p></td><td>General decline or other error. </td></tr>
	</tbody></table>
</center>

<p>
</p><h3>Preauth/Sale Example </h3>

<pre>         params = { 
                 'custid':    'mycustid', 
                 'password':  'mypasswd', 
                 'action':    'preauth', 
                 'amount':    '500', 
                 'cc':        '4111111111111111', 
                 'exp':       '0412', 
                 'name':      'Jennifer Smith', 
                 'address1':  '123 Test St.', 
                 'city':      'Somewhere', 
                 'state':     'CA', 
                 'zip':       '90001', 
                 'avs':       'y' 
         } 

         result = tclink.send(params) 

         if (result['status'] == 'approved'): 
                 print  'Transaction was successful' 
         elif (result['status'] == 'decline'): 
                 print 'Transaction declined.  Reason: ', result['declinetype'] 
         elif (result['status'] == 'baddata'): 
                 print 'Improperly formatted data.  Offending fields: ', result['offenders'] 
         else: 
                 print 'An error occurred: ', result['errortype'] 

         print 'Here are the full details:' 
         print result 
</pre>

<p>
</p><h2><a name="cvv"></a>VII. Card Verification Value (CVV) </h2>

<p>
Another method for cardholder verification is the CVV system. Visa
cards use what is called a CVV(II) or CVV2 code; MasterCard calls it
CVC2, and American Express calls it CID. CVV(II) and CVC2 (Visa/MC) are
located on the back of the credit card, printed in ink on the signature
strip. The number is the last three digits on the right hand side of
the long string of numbers on the strip. In the case of CID (AmEx), the
number is a four-digit value located on the front of the card, printed
just above the card number on the left hand side. This value is passed
to TCLink through the following parameter. </p><p>
</p><h3 align="center">CVV Parameters </h3>

<center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Parameter Name </th><th>Description </th></tr>
		<tr><td>cvv </td><td>A three or four digit CVV number. </td></tr>
		<tr><td>checkcvv </td><td>Set to "n" to disable CVV check, even if the value is
		passed.  Default is "y".</td></tr>
	</tbody></table>
</center>

<p>
The CVV value will be checked if anything is passed in this parameter.
(If you don't include the parameter, no CVV test will be run.) If the
CVV matches, the transaction will run as normal. If it does not, you
will receive a status of decline, and a declinetype of cvv.
</p><p>
In some cases you may wish to pass the CVV code without actually checking to confirm that it
is correct.  In that case set checkcvv=n.
</p><p>

</p><p>
</p><h3>CVV Example </h3>

<pre>         params = { 
                 'custid':    'mycustid', 
                 'password':  'mypasswd', 
                 'action':    'sale', 
                 'amount':    '500', 
                 'cc':        '4111111111111111', 
                 'exp':       '0412', 
                 'cvv':       '123' 
         } 

         result = tclink.send(params) 

         if (result['status'] == 'decline'):
                 if (result['declinetype'] == 'cvv'):
                         print 'The CVV number is not valid.' 
</pre>

<p>
</p><h2><a name="cardpresent"></a>VIII. Card-Present Transactions </h2>

<p>In a retail environment with a card swiper, you may wish to pass
magnetic stripe data along with the other credit card information on a
preauth or sale. There are two parameters which you can use to send
this data, named track1 and track2. Each one is for a different type of
track data, and depends on the type of card reader being used. </p><p>
</p><h3 align="center">Card-Present Parameters </h3>

<center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Parameter Name </th><th>Description </th></tr>
		<tr><td>track1 </td><td>Up to 79 bytes of Track 1 data. </td></tr>
		<tr><td>track2 </td><td>Up to 40 bytes of Track 2 data. </td></tr>
	</tbody></table>
</center>

<p>
You can include all data read from the track, but only data between the
start sentinel (a '%' character for track1 and a ';' for track2) and
the end sentinel ('?') will be used. Everything outside the start and
end sentinels (such as the trailing LRC character) will be discarded. </p><p>
The cc and exp fields may be passed, but are not required, since they
will be extracted from the track data. If you do pass one or both of
these fields, however, and it does not match the data extracted from
the track data, a status of baddata and an error mismatch will be
returned. </p><p>
If both track1 and track2 data are passed, the system will choose
track1 by default for the authorization, and track2 will be discarded. </p><p>
Generally AVS and address data are not necessary for swiped
transactions, but you may pass them anyway if you choose. All data
passed will be saved in the vault and can be downloaded for reports and
later analysis. </p><p>
</p><h3>Card Present Example </h3>

<pre>         params = { 
                 'custid':    'mycustid', 
                 'password':  'mypasswd', 
                 'action':    'sale', 
                 'amount':    '500' 
         } 

         params['track1'] = CardReader.readMagStripe() 

         result = tclink.send(params) 
</pre>

<p>
</p><h2><a name="ach"></a>IX. ACH </h2>

<p>
ACH, also known as electronic checks, is very different from credit
cards in that it allow a direct debit or credit to a checking account.
The concept of "authorization" does not exist; it is purely a money
transfer. For this reason, the only transaction types available for ACH
are sale and credit. ACH credits are identical to all other types of
credits in the TrustCommerce system, so please refer to <a href="#credits">postauths, credits and chargebacks </a>for details on issuing credits.  

</p><p>
ACH sales take the same parameters as credit card sales, with the
exception of the "cc" and "exp" fields. Instead, use the following
parameters. </p><p>
</p><h3 align="center">ACH Parameters </h3>

<center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Parameter Name </th><th>Description </th></tr>
		<tr><td>routing </td><td>The routing number of the bank being debited. </td></tr>
		<tr><td>account </td><td>The account number of the person or business being debited. </td></tr>
	</tbody></table>
</center>

<p>
AVS is not available for ACH transactions, so the AVS setting is ignored. 

</p><p>
There is only one declinetype returned from unsuccessful ACH sales, and that is "decline."  

</p><p>
</p><h3>ACH Example </h3>

<pre>         params = { 
                 'custid':    'mycustid', 
                 'password':  'mypass', 
                 'action':    'sale', 
                 'media':     'ach', 
                 'amount':    '1000', 
                 'routing':   '789456124', 
                 'account':   '55544433221' 
         } 

         tclink.send(params) 
</pre>

<p>
</p><h2><a name="credits"></a>X. Postauths, Credits, and Chargebacks </h2>

<p>
These three transaction types are similar in that they reference a
successful transaction previously executed through the TrustCommerce
system. These transaction types will not accept credit card information
or other personal information fields. There is only one required
parameter. </p><p></p><h3 align="center">Required Parameters </h3>

<center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Parameter Name </th><th>Description </th></tr>
		<tr><td>transid </td><td>The transaction ID (format: nnn-nnnnnnnnnn) of the referenced transaction.  </td></tr>
	</tbody></table>
</center>

<p>
In addition, postauths and credits can take an optional amount parameter. 

</p><h3 align="center">Optional Parameters </h3>

<center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Parameter Name </th><th>Description </th></tr>
		<tr><td>amount </td><td>The amount, in cents, to credit or postauth if it is not the same as the original amount.  </td></tr>
	</tbody></table>
</center>

<p>
If no amount is passed, the default will be to take the amount from the
original transaction. If, however, you wish to credit or postauthorize
less than the original amount, you may pass this parameter. </p><h3>Credit Example </h3>

<pre>         params = { 
                 'custid':    'mycustid', 
                 'password':  'mypass', 
                 'action':    'credit', 
                 'transid':   '001-0000111101' 
         } 

         tclink.send(params) 

         if (result['status'] != 'accepted'):
                 print 'Credit unsuccessful.' 
</pre>

<h2><a name="billingids"></a>XI. Citadel (Billing IDs) </h2>

<p>
The Citadel enables you to store customer billing information in an
encrypted TrustCommerce database. This information can then be recalled
with a single six-character alphanumeric code known as a billing ID.
Besides offloading the liability of storing sensitive data such as
credit card numbers from your business to TrustCommerce, the Citadel
can also simplify application development on your servers. </p><p>
The Citadel has two unique actions, store and unstore. These transction
types allow you to create, update, and deactivate billing IDs. Once
stored, the billing ID will be passed in place of the many billing
information fields for preauth and sale transactions. </p><h3 align="center">Store Parameters </h3>

<p>The store transaction looks very similar to a preauth or sale. You may pass <a href="#sales">credit card information </a>, billing and shipping address, or even <a href="#ach">ACH </a>information.  

</p><center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Parameter Name </th><th>Description </th></tr>
		<tr><td>verify </td><td>When set to "y", a $1.00 preauth will be run on the card to ensure that it is valid.  </td></tr>
		<tr><td>billingid </td><td>Pass if you wish to update values of an existing billing ID.  </td></tr>
	</tbody></table>
</center>

<p>
You can update information on existing billing IDs by passing the
billingid field along with the store transaction. If you wish to erase
the data contained in a field, pass the exact string "null" (four
characters, all lower case) as the parameter value. </p><p>
The verify parameter is useful for ensuring that the card number is
valid if you are not planning to bill the customer right away. It has
no effect for ACH billing IDs, because there is no such thing as an ACH
preauth. It is recommended that you pass avs=y for further verification
of the cardholder's data. Please note: normally, billing ID storage
returns a status of accepted, because the card is unverified. If you
use the verify parameter, however, it will return approved upon
success. </p><h3 align="center">Unstore Parameters </h3>

<p>The unstore action takes a single parameter: 

</p><center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Parameter Name </th><th>Description </th></tr>
		<tr><td>billingid </td><td>The six-character alphanumeric billing ID returned by a previous store transaction.  </td></tr>
	</tbody></table>
</center>

<p>
Unstore removes the billing ID from active use, and you won't be able
to run further transactions on it. For your convenience, however, it
does remain visible in Vault (flagged as an inactive ID), so you can
still look up old IDs if needed. </p><h3>Billing ID Example </h3>

<p>
To run a billing ID transaction, pass the billingid parameter to a
preauth or a sale in place of all of the usual billing info fields
(name, cc, exp, routing, account, etc). That's all there is to it!
You'll find that your sale or preauth transactions are now only a few
parameters: custid, password, billingid, and amount. </p><pre>         # First, store a new ID. 
         params = { 
                 'custid':    'mycustid', 
                 'password':  'mypass', 
                 'action':    'store', 
                 'cc':        '4111111111111111', 
                 'exp':       '0412', 
                 'name':      'Jennifer Smith' 
         } 

         result = tclink.send(params) 

         if (result['status'] == 'accepted'): 
                 # It was successfully stored.  Now try running a transaction on the new ID. 
                 billingid = result['billingid'] 
                 params2 = { 
                         'custid':    'mycustid', 
                         'password':  'mypass', 
                         'action':    'sale', 
                         'billingid': billingid, 
                         'amount':    '995' 
                 } 
                 tclink.send(params2); 
                 # Unstore the ID now that we are done. 
                 params3 = { 
                         'custid':    'mycustid', 
                         'password':  'mypass', 
                         'action':    'unstore', 
                         'billingid': billingid 
                 } 
                 tclink.send(params3) 
</pre>

<h2> <a name="recurring"></a>XII. Recurring Billing </h2>

<p>
Recurring billing (also called "subscription billing") is an extension
of the billing ID system. There are four parameters that are added to a
store which turn the billing ID into a recurring billing ID. They are
described below. </p><h3 align="center">Recurring Parameters </h3>

<center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Parameter Name </th><th>Required? </th><th>Default Value </th><th>Description </th></tr>
		<tr><td>cycle </td><td><p align="center">X </p></td><td>&nbsp;</td><td>Repeat cycle in days, weeks, months, or years. </td></tr>
		<tr><td>amount </td><td><p align="center">X </p></td><td>&nbsp;</td><td>Amount to bill in cents. </td></tr>
		<tr><td>start </td><td><br></td><td>&nbsp;</td><td>Date to start, or else offset from current date (defaults to now). </td></tr>
		<tr><td>payments </td><td><br></td><td>0</td><td>Number of payments to make (defaults to infinite). </td></tr>
		<tr><td>authnow </td><td><br></td><td>n</td><td>If 'y', performs the card authorization immediately.  Funds will be captured upon first payment cycle. <i>(requires start date)</i></td></tr>
		<tr><td>lastpaymentunstore </td><td><br></td><td>y</td><td>If 'y', the final payment in the billing cycle will result in the billing ID being unstored. </td></tr>
	</tbody></table>
</center>

<p>
Cycle is in the format of a number between 1 and 99 followed by a
character representing the time frame: 'd' for days, 'w' for weeks, 'm'
for months or 'y' for years. For example, a value of "3d" in this field
would cause the charge to recur every three days, whereas a value of
"2m" would cause it to recur every two months. </p><p>
Amount is identical to the amount passed to a sale or a preauth, and
indicates the amount of each charge made during the subscription. </p><p>
Start is an optional field which allows the delay of the cycle's start.
By default, the cycle starts the day the billing ID is stored. If it is
specified in the format YYYY-MM-DD, it indicates a date when the first
payment should be made. (For example, "2005-02-01" would be February 1,
2005.) If it is in the same format as the cycle (a number followed by a
character), it indicates an offset from the current date. (For example,
"1d" would start the billing tomorrow.) </p><p>
If there is no start parameter, the first transaction is run
immediately (and can cause the store action to return a "decline" or
other result you would expect from a sale). Other return parameters
associated with auths, such as avs code, will be returned as well. </p><p>
If you pass authnow=y, an immediate authorization will be performed for
the payment amount, but the funds will not be captured until the start
date is reached. This is handy for free trial accounts: because the
funds are authorized immediately, you are assured the money. If they
cancel sometime between the time the billing ID is stored and the start
date of the billing cycle, you can unstore the ID and they will never
be charged. Their free trial will be the time between the billing ID
store and the billing cycle start date. Authnow requires that a start
date be specified.
</p><p>The payments field is also optional; left blank or set to zero
it will continue the billing cycle until it is manually interrupted by
an unstore, or by updating the billing ID with cycle set to "null".
Once the final payment is made, the billing ID will be unstored, unless
lastpaymentunstore is set to 'n'. lastpaymentunstore should only be
used when the number of payments is specified.
</p><p>There is only one instance in which the cycle parameter is not
required, and that is a one-time future payment. By setting payments to
"1" and passing a start date, the payment will be made on that date and
then the billing ID unstored. The cycle parameter may be included with
a one-time future payment, but it will have no effect. </p><h3>Recurring Billing Example </h3>

<pre>         params = { 
                 'custid':    'mycustid', 
                 'password':  'mypass', 
                 'action':    'store', 
                 'cc':        '4111111111111111', 
                 'exp':       '0412', 
                 'name':      'Jennifer Smith', 
                 'amount':    '1200' 
         } 

         mode = chooseSubscriptionMode() 

         if (mode == 1): 
                 # Make a payment every day, infinitely (or until someone manually disables it) 
                 params['cycle'] = '1d'; 
         elif (mode == 2): 
                 # Make a payment once a month for one year 
                 params['cycle'] = '1m'; 
                 params['payments'] = '12'; 
         elif (mode == 3): 
                 # Make a payment every six weeks, starting one week from now 
                 params['cycle'] = '62'; 
                 params['start'] = '1w'; 
         elif (mode == 4): 
                 # Make annual payments, and don't start until September 1, 2007 
                 params['cycle'] = '1y'; 
                 params['start'] = '2007-09-01'; 
         elif (mode == 5): 
                 # Make a one time payment in 45 days 
                 params['start'] = '45d'; 
                 params['payments'] = '1'; 

         tclink.send(params) 
</pre>

<h2><a name="wallet"></a>XIII. TC Wallet </h2>

<p>
The TC Wallet is an additional service offered by the TrustCommerce
gateway that allows you to run many small micro payments which are
later lumped together and submitted as a single, large payment. This
can offer a substantial savings for the merchant in transaction fees,
as merchant account providers tend to penalize merchants that run small
payments. </p><h3 align="center">Wallet Parameters </h3>

<p>
The Wallet is an extension of the billing ID system. It adds three new parameters to the store action, described below. 

</p><center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Parameter Name </th><th>Description </th></tr>
		<tr><td>wallet </td><td>"y" to enable the wallet. </td></tr>
		<tr><td>walletsize </td><td><p>Accumulated amount, in cents, before the wallet is submitted for capture.  </p></td></tr>
		<tr><td>walletexposure </td><td>Length of time to wait before capturing the wallet. </td></tr>
	</tbody></table>
</center>

<p>
In order to enable wallets for the billing ID that you are storing, set
the "wallet" parameter to "y". The other two parameters are optional,
as there are default values attached to your TC account. If you wish to
change these default values (which are normally $10.00 and 72 hours)
please contact TrustCommerce. If you wish to change the values for an
individual billing ID without changing your defaults, include these
parameters. </p><p>
Once the billing ID is stored, it is possible to use a new action type
on the ID called walletsale. It is identical to a sale in all ways,
except that it can only be used on wallet-enabled billing IDs, and it
can accept amounts anywhere from $0.01 up to the size of the wallet.
Walletsale will usually return "approved", but it may return "decline"
if the stored credit card fails to re-authorize when the current wallet
is exceeded. Except for these two modifications (the wallet parameters
on the store, and changing sales to walletsales), there is no extra
development to be done client-side to make wallets work. Captures
happen automatically after walletexposure has expired or the
walletamount has been used up; reauthorizations also happen
automatically. </p><h3>Wallet Example </h3>

<pre>         # First, store a new ID with the wallet enabled. 
         params = { 
                 'custid':    'mycustid', 
                 'password':  'mypass', 
                 'action':    'store', 
                 'cc':        '4111111111111111', 
                 'exp':       '0412', 
                 'name':      'Jennifer Smith', 
                 'wallet':    'y' 
         } 

         result = tclink.send(params) 

         if (result['status'] == 'approved'): 
                 # We have a new wallet at our disposal.  Run a micropayment on it. 
                 billingid = result['billingid'] 
                 params2 = { 
                         'custid':    'mycustid', 
                         'password':  'mypass', 
                         'action':    'walletsale', 
                         'billingid': billingid, 
                         'amount':    '995' 
                 } 
                 tclink.send(params) 
</pre>

<a name="crediguard-neural"></a><h2>XIV. CrediGuard - Neural Network Fraud Scoring</h2>

When the CrediGuard Neural Network is enabled, a fraud score is assigned to
each transaction based on its appearance of fraud or legitimacy. This score is
determined by running each transaction through an advanced artificial
intelligence neural network that is trained to recognize fraudulent
transactions.<p>

The fraud score represents an evaluation of how legitimate or fraudulent the
transaction appears. A fraud score close to 0 means that the transaction is
likely to be fraudulent, while a fraud score close to 100 means that the
transaction is likely to be legitimate.</p><p>

The CrediGuard Score Threshold is a number from 0 to 100 that controls how
restrictive the CrediGuard fraud screening system should be. Any transaction
with a fraud score less than the CrediGuard score threshold will be declined.
All other transactions will be accepted as per usual. The following chart sums
up the effects of the possible CrediGuard score threshold ranges:

</p><p>
</p><center>
<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
<tbody><tr><th>Score Threshold Range</th>
<th>Blocking Effect</th></tr>

<tr><td align="right">0</td><td>Allow All</td></tr>
<tr><td align="right">1 - 25</td><td>Allow Most</td></tr>
<tr><td align="right">26 - 50</td><td>Normal</td></tr>
<tr><td align="right">51 - 75</td><td>Restrictive</td></tr>
<tr><td align="right">76 - 100</td><td>Highly Restrictive</td></tr>
</tbody></table>
</center>
<p>

The default score threshold can be configured within the Vault web interface.
To override the default score threshold, you can optionally pass in an extra
parameter to set a different score threshold for the current transaction only:

</p><h3 align="center">CrediGuard Parameters</h3>

<p>
</p><center>
<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
<tbody><tr><th>Parameter Name</th><th>Description</th></tr>
<tr><td>threshold</td><td>The fraud threshold for the current
transaction. If the transaction receives a Fraud Score below this
threshold, it will be declined.</td></tr>
</tbody>
</table>
</center>
<p>

With Neural Network scoring enabled, the return parameters for each
transaction will contain an additional parameter for the calculated fraud
score:

</p><h3 align="center">CrediGuard Return Parameters</h3>

<p>
</p><center>
<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
<tbody><tr><th>Parameter Name</th><th>Description</th></tr>
<tr><td>fraudscore</td><td>The actual numeric score, 0 to 100, that the Crediguard Neural Network gave to the transaction.</td></tr>
</tbody>
</table>
</center>
<p>

</p><h3>CrediGuard Neural Network Example </h3>

<pre>         params = { 
                 'custid':    'mycustid', 
                 'password':  'mypasswd', 
                 'action':    'sale', 
                 'amount':    '500', 
                 'cc':        '4111111111111111', 
                 'exp':       '0412', 
                 'threshold': '45',
         } 

         result = tclink.send(params) 

         if (result['status'] == 'decline'):
                 if (result['declinetype'] == 'fraud'):
                         print 'Transaction declined based on fraud score.'
</pre>

You may also wish to handle the score result yourself, perhaps with fuzzy logic
that treats a certain range of low scores as out-and-out declines, a high
range as approvals, and a middle range as accepting pending further processing.
The last category of transactions could be set aside in your local database or
perhaps trigger an email to a customer service rep, who could manually review
the transaction, and perhaps call the customer for verification.
<p>

</p><h3>CrediGuard Fuzzy Logic Scoring Example </h3>

<pre>         score_bottom = 30
         score_top = 70

         params = { 
                 'custid':    'mycustid', 
                 'password':  'mypasswd', 
                 'action':    'sale', 
                 'amount':    '500', 
                 'cc':        '4111111111111111', 
                 'exp':       '0412', 
                 'threshold': score_bottom
         } 

         result = tclink.send(params) 

         if (result['status'] == 'decline'):
                 if (result['declinetype'] == 'fraud'):
                         print 'Transaction declined, score was too low.'

         if (result['status'] == 'approved'):
                 if (result['fraudscore'] &gt; score_top):
                         print 'Transaction approved'
                 else:
                         print 'Transaction accepted pending review'


</pre>

<a name="crediguard-blacklist"></a><h2>XV. CrediGuard - Blacklists</h2>

Blacklists are used to block specific cardholder information that you know to
be fraudlent. The most common example would be a customer who keeps using a
credit card that caused chargebacks in the past. You can block the customer
from running charges on the card by entering their credit card number as a
blacklist value.<p>

Blacklist rules are configured from within the Vault web interface and
apply to all transactions, so there are no blacklist input parameters that
you need to pass in with TCLink.</p><p>

If a transaction is declined because it matches a blacklist rule that you
have created, the reason for this decline will be returned via the following
parameters:

</p><p>
</p><h3 align="center">Blacklist Return Parameters</h3>
<center>
<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
<tbody><tr><th>Parameter Name</th><th>Description</th></tr>
<tr><td>blacklistfield</td><td>The name of the input field that
contained the blacklisted value. This can be one of "name", "cc",
"zip", "address1", "state", "country", "email", "phone", or "ip".</td></tr>
<tr><td>blacklistvalue</td><td>The input value that triggered the
blacklist decline. For instance, if the decline was due to a
blacklisted IP address, the offending IP address would be returned here.</td></tr>
</tbody>
</table>
</center>
<p>

</p><h3>Blacklist Example </h3>

<pre>         params = { 
                 'custid':    'mycustid', 
                 'password':  'mypasswd', 
                 'action':    'sale', 
                 'amount':    '500', 
                 'cc':        '4111111111111111', 
                 'exp':       '0412', 
         } 

         result = tclink.send(params) 

         if (result['status'] == 'decline'):
                 if (result['declinetype'] == 'blacklist'):
                         print 'Transaction declined based on blacklist rule.'
                         print 'The offending field was: ' + result['blacklistfield']
                         print 'And the blacklisted value was: ' + result['blacklistvalue']

</pre>

<a name="crediguard-velocity"></a><h2>XVI. CrediGuard - Velocity Control</h2>

In the world of payment processing, 'velocity' refers to limiting the number
or amount of transactions which occur over a set period of time.  This allows
you, the merchant, to control your risk.  The most common use of velocity
would be to limit the dollar amount spent per day on a single credit card.
But the CrediGuard package supports a wide variety of velocity parameters,
allowing you to tailor them to match the usage patterns of your customers and
thereby control your risk factor.

<p>
CrediGuard can perform four different types of velocity checks:
</p><p>
</p><h3 align="center">Velocity Types</h3>
<center>
<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
<tbody><tr><th>Velocity Type</th><th>Description</th></tr>
<tr><td>Global</td><td>All transactions</td></tr>
<tr><td>Zipcode</td><td>Transactions on the same zipcode</td></tr>
<tr><td>IP Address</td><td>Transactions sent from the same Internet address</td></tr>
<tr><td>Credit Card</td><td>Transactions on the same credit card</td></tr>
</tbody>
</table>
</center>
<p>

Each of the four velocity types offers a <b>count</b> (number of transactions)
and a <b>total</b> (dollar amount sum).  For each of those two values, there
are four time periods, ranging from one day to one month. All of these
velocity settings are configured from within the Vault web interface and apply
to all transactions, so there are no velocity input parameters that you need
to pass in with TCLink.</p><p>

If a transaction is declined on the basis of exceeding one of these velocity
settings, the reason for this decline will be returned via the following
parameters:

</p><p>
</p><h3 align="center">Velocity Return Parameters</h3>
<center>
<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
<tbody><tr><th>Parameter Name</th><th>Description</th></tr>
<tr><td>velocitytype</td><td>A brief string that contains the precise
reason for the velocity decline. The first part of this string contains
a velocity type, either "global", "zip", "ip", or "cc". The next part
of the string contains a time period, either "1day", "3day", "15day",
or "30day". The end of the string is "count" if the transaction count
for the velocity type and time period was exceeded, or "total" if the
dollar amount sum was exceeded. For example, "zip3daycount" would be
returned if the velocity transaction count was exceeded for a
particular zip code in a three day period.</td></tr>
<tr><td>velocityvalue</td><td>The input value that triggered the
velocity decline. For instance, if the decline was due to a zip code
velocity setting, the offending zip code would be returned here.</td></tr>
</tbody>
</table>
</center>
<p>

</p><h3>Velocity Example </h3>

<pre>         params = { 
                 'custid':    'mycustid', 
                 'password':  'mypasswd', 
                 'action':    'sale', 
                 'amount':    '500', 
                 'cc':        '4111111111111111', 
                 'exp':       '0412', 
         } 

         result = tclink.send(params) 

         if (result['status'] == 'decline'):
                 if (result['declinetype'] == 'velocity'):
                         print 'Transaction declined based on ' + result['velocitytype'] + ' velocity controls.'
</pre>

<h2><a name="pl2"></a>XVII. Purchase Level II </h2>

<p>
Purchase Level II is required by some merchant banks to achieve a
qualified discount rate. It is only used for B2B or B2G transactions.
If you are selling products directly to consumers, you do not need to
use PL2. Additionally, PL2 can only be used if the cardholder is using
one of the three types of commercial cards: a corporate card, a
business card, or a purchasing card. </p><h3 align="center">PL2 Input Parameters </h3>

<p>
PL2 has three new parameters: 

</p><center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Parameter Name </th><th>Description </th></tr>
		<tr><td>purchaselevel </td><td>Specify as "2". </td></tr>
		<tr><td>purchaseordernum </td><td>The
purchasing order number from their Visa purchasing card. This is either
a 16 or a 17 digit number. If they are not using a Visa purchasing
card, do not pass this field. </td></tr>
		<tr><td>tax </td><td>The amount of tax, in cents, charged for the order. If the order is tax exempt omit this field or set it to 0.  </td></tr>
	</tbody></table>
</center>

<p>

</p><h3 align="center">PL2 Output Parameter </h3>

<p>
A successful PL2 transaction will return one extra response parameter 
</p><center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Parameter Name </th><th>Description </th></tr>
		<tr><td>commercialcard </td><td>Set to "S" for if it is a purchasing card, "R" if it is corporate card, and "B" if it is a business card.  </td></tr>
	</tbody></table>
</center>

<p>
If you don't care what kind of card they used (which you probably
don't), there is no reason to store or otherwise do anything with the
commercialcard return value. TrustCommerce internally handles all the
details for you. However, if you want this information for some reason,
you can access it from the result parameters. </p><h3>Purchase Level II Example </h3>

<pre>         params = { 
                 'custid':           'mycustid', 
                 'password':         'mypass', 
                 'action':           'sale', 
                 'cc':               '4111111111111111', 
                 'exp':              '0412', 
                 'amount':           '1000' 
                 'name':             'Jennifer Smith', 
                 'purchaselevel':    '2' 
                 'purchaseordernum': '12345678901234567' 
                 'tax':              '83'    # $10.00 x 8.25% sales tax = $0.83 

         } 

         result = tclink.send(params) 

         if (result['status'] == 'approved'): 
                 print 'Approved' 
</pre>

<h2><a name="orderdetail"></a>XVIII. Automated Fulfillment </h2>

<p>
TrustCommerce offers the unique feature of automated fulfillment, by
which orders submitted through the TCLink API can contain parameters
describing product information. This information is then passed on to
your fulfillment house, which ships the products automatically. Even if
you aren't using automated fulfillment, you can use the order line item
specification parameters to store information in the TrustCommerce
transaction database about the type of products ordered. </p><p>
First, you may wish to specify the shipping address for the customer.
If it is the same as the billing address, you need not duplicate it,
but rather just send the shiptosame parameter set to y. The table below
lists the shipping parameters. </p><h3 align="center">Ship To Parameters </h3>

<center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Parameter Name </th><th>Description </th></tr>
		<tr><td>shiptosame </td><td>y or n (defaults to n). If "y", then no other shipto_ parameters should be passed.  </td></tr>
		<tr><td>shipto_name </td><td>Name of the product recipient. </td></tr>
		<tr><td>shipto_address1 </td><td>First line of shipping address. </td></tr>
		<tr><td>shipto_address2 </td><td>Second line (if any) of shipping address. </td></tr>
		<tr><td>shipto_city </td><td>City. </td></tr>
		<tr><td>shipto_state </td><td>State. </td></tr>
		<tr><td>shipto_zip </td><td>Zip code, five or nine digits (no spaces or dashes). </td></tr>
		<tr><td>shipto_country </td><td>Country, leave blank for US. </td></tr>
	</tbody></table>
</center>

<p>

</p><h3 align="center">Order Header Parameters </h3>

<p>
Second, some additional data about the order as a whole should be passed in the form of the following parameters.   

</p><center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Parameter Name </th><th>Description </th></tr>
		<tr><td>shippingcode </td><td>Three character code indicating shipping method to use. </td></tr>
		<tr><td>shippinghandling </td><td>The total cost of shipping and handling, in cents. </td></tr>
		<tr><td>numitems </td><td>Total number of distinct items (product codes) in the order. </td></tr>
	</tbody></table>
</center>

<p>

</p><h3 align="center">Order Detail Parameters </h3>

<p>
Finally, a number of parameters which describe the details of each type
of item must be passed. In the table below, the 'X' character in the
parameter name should be replaced with a digit indicating which item it
applies to. For example, if numitems is set to three, then you should
pass three product codes, in the form of productcode1, productcode2,
and productcode3. </p><center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Parameter Name </th><th>Description </th></tr>
		<tr><td>productcodeX </td><td>The alphanumeric product code defined by the fulfillment house.  </td></tr>
		<tr><td>quantityX </td><td>The number of items of this type to be shipped. </td></tr>
		<tr><td>priceX </td><td>The price of all items of this type not including sales tax or shipping, in cents.  </td></tr>
		<tr><td>taxX </td><td>Total tax charged for all items of this product code. </td></tr>
		<tr><td>shippinghandlingX </td><td>Total shipping and handling charged for all items of this product code.  </td></tr>
	</tbody></table>
</center>

<p>
Please note: the shippinghandling field and the shippinghandlingX
fields are mutually exclusive. Use one or the other, but not both. If
you're not sure which to use, please contact your fulfillment house. </p><h3>Fulfillment Example </h3>

<pre>         params = { 
                 'custid':           'mycustid', 
                 'password':         'mypass', 
                 'action':           'preauth', 
                 'cc':               '4111111111111111', 
                 'exp':              '0412', 
                 'amount':           '1979',  # Total of items, tax, and shipping 
                 'name':             'Jennifer Smith', 
                 'address1':         '123 Test St.', 
                 'city':             'Somewhere', 
                 'state':            'CA', 
                 'zip':              '90001', 
                 'shiptosame':       'y',     # Shipping address is same as billing address 

                 'numitems':         '2',     # Two total product codes will be described 
                 'shippingcode':     'OVRNGT', 
                 'shippinghandling': '695', 

                 'productcode1':     'PCODE1', 
                 'quantity1':        '3', 
                 'price1':           '600',   # Item 1 costs $2.00, and there are 3 of them 
                 'tax1':             '144',   # Tax of 8% 

                 'productcode2':     'PCODE2', 
                 'quantity2':        '1', 
                 'price2':           '500',   # Item 1 costs $5.00, there's only one 
                 'tax2':             '40'     # Tax of 8% 
         } 

         tclink.send(params) 
</pre>

<h2><a name="batchProcessing"></a>XIX. Batch Processing </h2>

<p>
The TrustCommerce Batch Processing service allows programmers to submit
an unlimited number of transactions in a single file for offline
processing. The file can contain a mixture of transaction types
(preauths and postauths, credits, sales, stores and unstores for
example) and can use Citadel Billing IDs, ACH Routing codes or credit
card information to identify the account to be charged. In fact, any
field found in <u>Appendix E &#8364;&#8220; Input Field List</u> of this guide can be included.  

</p><h3 align="center">Naming Conventions </h3>

<p>
While there is no required naming convention for the transaction file
sent to TrustCommerce, we recommend the convention shown in the table
below. </p><p>
The results file that we return to you will use your file name with the prefix "result-". 

</p><center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Recommended File Name</th><th>Description</th></tr>
		<tr><td>batch-[custid]-[mmddyy][x].txt </td><td>This is the input file containing the list of transactions to be processed.  
			<p><br>This
file MUST be in comma separated values (CSV) format and the first row
MUST contain the field names for all fields that you choose to include
(See <a href="#inputfields"><u>Appendix E </u></a>.) Individual records are not required to contain values for each field.  
			</p><p>[custid] is your numeric TrustCommerce custid. [mmddyy] is a numeric date.  
			</p><p>[x] is an optional alpha identifier to distinguish batches if multiple batches are sent in one day.  
			</p><p>Do not include the "[" or "]"characters in the file name.  </p></td></tr>
		<tr><td>result-[your file name].txt </td><td>This file contains a response record for each transaction record sent in the batch file.  </td></tr>
	</tbody></table>
</center>
<p>
</p><center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><td>NOTE:
The records in the results file will be sequenced in exactly the same
order as the original input file. If you require a more positive
identifier for each record (invoice number for example) include the
required value in the "ticket" field of your input file. This value
will be echoed back to you in the "ticket" field of the results file.
See the examples below.</td></tr>
	</tbody></table>
</center>

<p>
<b>Sample Batch Upload File</b>

</p><p>
To invoke the Batch Processing service use your programming language's HTTPS POST function and point it at <a href="https://batch.trustcommerce.com/submit.php"><u>https://batch.trustcommerce.com/submit.php </u></a>. 

</p><p>
A sample batch upload file might look like this: 

</p><pre> ticket,action,cc,exp,amount,name,email 
 01-1224,sale,4111111111111111,0412,999,Test Person,person@example.com 
 00-1175,preauth,4111111111111111,0412,333,Test Person,person@example.com  
</pre>

<p>
<b>Sample Batch Response File</b>

</p><p>The response file will contain one response record for each uploaded transaction record. 

</p><p>
The results file can then be downloaded interactively from the Vault or
by invoking your language's HTTPS POST function pointed at <a href="https://batch.trustcommerce.com/download.php"><u>https://batch.trustcommerce.com/download.php </u></a>. 

</p><p>
A sample response file might look like this: 

</p><pre>ticket,status,transid,billingid,declinetype,errortype,offenders,avs
 01-1224,approved,010-0001364786,,,,,N
 00-1175,approved,010-0001364785,,,,,N
</pre>

<p>
<b>Status Reporting</b>

</p><p>
Email is the primary means used by the Batch Processing service to
provide status updates. Status updates will be sent to the same email
address used for Daily Reports emails. This email address can be
modifed on the "Settings" page of the Vault's web interface.
</p><p>After uploading your file, the system will respond immediately
with an "Acknowledged" message and then follow by sending an email with
a subject similar to the following: </p><p>
Subject: Batch File [your file name] Picked Up 

</p><p>
The content of the mail will provide processing statistics including the number of records found in the file.  

</p><p>
When processing is complete, a second e-mail will be sent. The subject this time will look like: 

</p><p>
Subject: Batch File [your file name] Complete

</p><p>
The body of this email will contain relevant information including the number of approvals, declines, accepts and settlements.  

</p><p>
<b>Sample Code</b>

</p><p>
The sample HTML code shown below illustrates the functionality of the
Batch Processing service invocation of the TCLink API. It can be pasted
into a file and loaded on your web browser in order to experiment with
batch processing before you even begin to write your code. </p><p>
<b>Batch Upload Example</b>

</p><pre> &lt;html&gt; 
 &lt;head&gt; &lt;title&gt; TrustCommerce Batch Upload Interface &lt;/title&gt; &lt;/head&gt; 
 &lt;body&gt; 
 &lt;h2&gt; TrustCommerce Batch Upload Interface &lt;/h2&gt; 

 &lt;form action=https://batch.trustcommerce.com/submit.php method=post 
 enctype=multipart/form-data&gt; 
         &lt;table align=center border=1&gt; 
         &lt;tr&gt; 
                 &lt;td&gt; custid &lt;/td&gt; 
                 &lt;td&gt; &lt;input type=text name=custid&gt; &lt;/td&gt; 
                 &lt;td&gt; This is your TrustCommerce custid (required) &lt;/td&gt; 
         &lt;/tr&gt; 
         &lt;tr&gt; 
                 &lt;td&gt; password &lt;/td&gt; 
                 &lt;td&gt; &lt;input type=password name=password&gt; &lt;/td&gt; 
                 &lt;td&gt; This is your TrustCommerce password (required) &lt;/td&gt; 
         &lt;/tr&gt; 
         &lt;tr&gt; 
                 &lt;td&gt; batch file &lt;/td&gt; 
                 &lt;td&gt; &lt;input name=file type=file&gt; &lt;/td&gt; 
                 &lt;td&gt; This is the batch file to upload (required) &lt;/td&gt; 
         &lt;/tr&gt; 
         &lt;tr&gt; 
                 &lt;td colspan=3&gt; &lt;input type=submit&gt; &lt;/td&gt; 
         &lt;/tr&gt; 
         &lt;/table&gt; 
 &lt;/form&gt; 
 &lt;/body&gt; 
 &lt;/html&gt; 
</pre>

<p>
<b>Batch Results Download Example</b> 

</p><pre> &lt;html&gt; 
 &lt;head&gt; &lt;title&gt; TrustCommerce Batch Results Download Interface &lt;/title&gt; &lt;/head&gt; 
 &lt;body&gt; 
 &lt;h2&gt; TrustCommerce Batch Results Download Interface &lt;/h2&gt; 

 &lt;form action=https://batch.trustcommerce.com/download.php method=post&gt; 
         &lt;table align=center border=1&gt; 
         &lt;tr&gt; 
                 &lt;td&gt; custid &lt;/td&gt; 
                 &lt;td&gt; &lt;input type=text name=custid&gt; &lt;/td&gt; 
                 &lt;td&gt; This is your TrustCommerce custid (required) &lt;/td&gt; 
         &lt;/tr&gt; 
         &lt;tr&gt; 
                 &lt;td&gt; password &lt;/td&gt; 
                 &lt;td&gt; &lt;input type=password name=password&gt; &lt;/td&gt; 
                 &lt;td&gt; This is your TrustCommerce password (required) &lt;/td&gt; 
         &lt;/tr&gt; 
         &lt;tr&gt; 
                 &lt;td&gt; result file name &lt;/td&gt; 
                 &lt;td&gt; &lt;input name=file type=text&gt; &lt;/td&gt; 
                 &lt;td&gt; This is the result file name to download (required) &lt;/td&gt; 
         &lt;/tr&gt; 
         &lt;tr&gt; 
                 &lt;td colspan=3&gt; &lt;input type=submit&gt; &lt;/td&gt; 
         &lt;/tr&gt; 
         &lt;/table&gt; 
 &lt;/form&gt; 
 &lt;/body&gt;
 &lt;/html&gt;
</pre>

<h2> <a name="query"></a>XX. Vault Query API </h2>

<p>
The Vault website serves as a web-based interface for merchant
reconciliation. On the back end, it is a complex database that tracks
all transactional data for your TrustCommerce account. The information
contained in the Vault can be accessed at the API level using a
standard CGI query over HTTPS. </p><p>
The query API returns data in CSV (comma separated value) format, which
is just a flat text file with fields separated by commas, and records
separated by newlines. (You can also request the data returned in an
HTML table, which is useful for debugging.) The first line of the file
contains the name of each field that will be returned in subsequent
records. </p><p>
The parameters that the query interface accepts are described in the table below. 

</p><h3 align="center">Required Parameters </h3>

<center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Parameter Name </th><th>Required? </th><th>Description </th></tr>
		<tr><td>custid </td><td><p align="center">X </p></td><td>TrustCommerce customer ID number. </td></tr>
		<tr><td>password </td><td><p align="center">X </p></td><td>The password for your custID. </td></tr>
		<tr><td>format </td><td><br></td><td>Set to "html" for human-readable HTML output, or "text" (default) for CSV text output. </td></tr>
		<tr><td>querytype </td><td><p align="center">X </p></td><td>Possible
values are: chain, transaction, summary, or billingid, corresponding to
the equivalent reports on the Vault website. Read the User's Guide for
further description of each report type. </td></tr>
		<tr><td>media </td><td><br></td><td>Set to "cc" (default) or "ach" for media type.  </td></tr>
		<tr><td>begindate </td><td><br></td><td>Begin date for query, format: MM-DD-YYYY HH:MM:SS </td></tr>
		<tr><td>enddate </td><td><br></td><td>End date for query, format: MM-DD-YYYY HH:MM:SS  </td></tr>
		<tr><td>chain </td><td><br></td><td>Narrow search to a single chain of transactions. </td></tr>
		<tr><td>transid </td><td><br></td><td>Narrow search to a single transaction ID. </td></tr>
		<tr><td>billingid </td><td><br></td><td>Narrow search to a single billing ID. </td></tr>
		<tr><td>pastdue </td><td><br></td><td>Use 'y' or 'n'. For billing ID search. Show only recurring billing IDs that have been unable to capture the requested funds. </td></tr>
		<tr><td>action </td><td><br></td><td>Narrow search by action (preauth, sale, credit, etc).  </td></tr>
		<tr><td>status </td><td><br></td><td>Narrow search by status (approved, accepted, decline, etc).  </td></tr>
		<tr><td>name </td><td><br></td><td>Narrow search by cardholder name, partial or complete. </td></tr>
		<tr><td>cc </td><td><br></td><td>Narrow search by credit card number. </td></tr>
		<tr><td>ticket </td><td><br></td><td>Narrow search by contents of the ticket field. </td></tr>
		<tr><td>limit </td><td><br></td><td>Do not allow size of result set to exceed this number of records.  </td></tr>
		<tr><td>offset </td><td><br></td><td>Report
result set starting from this offset. Use this parameter in conjunction
with limit in order to page through a large result set. </td></tr>
		<tr><td>showcount </td><td><br></td><td>Show the number of records returned on the last line of the result set. </td></tr>
	</tbody></table>
</center>

<p>
The sample HTML code shown below illustrates the functionality of the
query API. It can be pasted into a file and loaded on your web browser
in order to try out some queries before you even begin to write your
code. </p><h3>Query Example HTML </h3>

<pre>&lt;html&gt;
&lt;head&gt; &lt;title&gt; TrustCommerce Query Interface &lt;/title&gt; &lt;/head&gt;
&lt;body&gt;
&lt;h2&gt; TrustCommerce Query Interface &lt;/h2&gt;
&lt;form action=https://vault.trustcommerce.com/query/&gt;
	&lt;table align=center border=1&gt;
	&lt;tr&gt;
		&lt;td&gt; custid &lt;/td&gt;
		&lt;td&gt; &lt;input type=text name=custid&gt; &lt;/td&gt;
		&lt;td&gt; This is your TrustCommerce custid (required) &lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt; password &lt;/td&gt;
		&lt;td&gt; &lt;input type=password name=password&gt; &lt;/td&gt;
		&lt;td&gt; This is your TrustCommerce password (required) &lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt; format &lt;/td&gt;
		&lt;td&gt; &lt;select name=format&gt; &lt;option value=text&gt;text&lt;/option&gt;
				&lt;option value=html&gt;html&lt;/option&gt;&lt;/select&gt;&lt;/td&gt;
		&lt;td&gt; Human readable (html) or computer readable (text) results&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt; Query type &lt;/td&gt;
		&lt;td&gt; &lt;select name=querytype&gt; 
		&lt;option value=chain&gt;chain&lt;/option&gt;
		&lt;option value=transaction&gt;transaction&lt;/option&gt;
		&lt;option value=summary&gt;summary&lt;/option&gt;
		&lt;option value=billingid&gt;billingid&lt;/option&gt;
		&lt;/select&gt;&lt;/td&gt;
		&lt;td&gt; Type of query &lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt; media &lt;/td&gt;
		&lt;td&gt; &lt;input type=text name=media value=cc&gt; &lt;/td&gt;
		&lt;td&gt; For now this must be cc &lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt; begindate MM-DD-YYYY HH:MM:SS &lt;/td&gt;
		&lt;td&gt; &lt;input type=text name=begindate&gt; &lt;/td&gt;
		&lt;td&gt; Query begins at this date&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt; enddate MM-DD-YYYY HH:MM:SS &lt;/td&gt;
		&lt;td&gt; &lt;input type=text name=enddate&gt; &lt;/td&gt;
		&lt;td&gt; Query ends at this date&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt; chain &lt;/td&gt;
		&lt;td&gt; &lt;input type=text name=chain&gt; &lt;/td&gt;
		&lt;td&gt; Narrow search to a single chain of transactions &lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt; transid &lt;/td&gt;
		&lt;td&gt; &lt;input type=text name=transid&gt; &lt;/td&gt;
		&lt;td&gt; Narrow search to a single transactions &lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt; billingid &lt;/td&gt;
		&lt;td&gt; &lt;input type=text name=transid&gt; &lt;/td&gt;
		&lt;td&gt; Narrow search to a single billingid &lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt; pastdue &lt;/td&gt;
		&lt;td&gt; &lt;select name=pastdue&gt; 
		&lt;option value=y&gt;y&lt;/option&gt;
		&lt;option value=n&gt;n&lt;/option&gt;
		&lt;/select&gt;&lt;/td&gt;
		&lt;td&gt; Use 'y' or 'n'. For billing ID search.  Show only recurring billing IDs
		     that have been unable to capture the requested funds. &lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt; action &lt;/td&gt;
		&lt;td&gt; &lt;input type=text name=action&gt; &lt;/td&gt;
		&lt;td&gt; Narrow search by action. (example: preauth,postauth) &lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt; status &lt;/td&gt;
		&lt;td&gt; &lt;input type=text name=status&gt; &lt;/td&gt;
		&lt;td&gt; Narrow search by status. (example: approved,accepted) &lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt; name &lt;/td&gt;
		&lt;td&gt; &lt;input type=text name=name&gt; &lt;/td&gt;
		&lt;td&gt; Narrow search by name. &lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt; cc &lt;/td&gt;
		&lt;td&gt; &lt;input type=text name=cc&gt; &lt;/td&gt;
		&lt;td&gt; Narrow search by credit card field. &lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt; limit &lt;/td&gt;
		&lt;td&gt; &lt;input type=text name=limit value=20&gt; &lt;/td&gt;
		&lt;td&gt; Limit results to this number of fields (not used for summary)&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt; offset &lt;/td&gt;
		&lt;td&gt; &lt;input type=text name=offset value=0&gt; &lt;/td&gt;
		&lt;td&gt; Report results at this offset (used with limit to page through results)&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt; showcount &lt;/td&gt;
		&lt;td&gt; &lt;select name=showcount&gt; 
		&lt;option value=y&gt;yes&lt;/option&gt;
		&lt;option value=n&gt;no&lt;/option&gt;
		&lt;/select&gt;&lt;/td&gt;
		&lt;td&gt; Show the number of not-limited rows on the last line of the result&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td colspan=3&gt; &lt;input type=submit&gt; &lt;/td&gt;
	&lt;/tr&gt;
	&lt;/table&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>

<h2> <a name="testdata"></a>Appendix A - Test Data </h2>

<p>
While testing, you may wish to experiment with the different responses
that the gateway can generate. The following test card numbers will
produce an approval, and have address data as listed, for testing AVS.
If you wish to test CVV, the code listed int he right-hand column is
the correct CVV code, Other valid credit cards will work, but will
produce a 'U' AVS code. </p><p>
Please note: these cards ONLY work on transactions flagged as demo, or
while your account is in "test" mode! For a live transaction, they will
all return a decline with a declinetype of carderror. </p><h3 align="center">Test Cards - Approved </h3>

<center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Card Type </th><th>Card Number </th><th>Exp </th><th>Address </th><th>City </th><th>State </th><th>Zip </th><th>CVV </th></tr>
		<tr><td>Visa </td><td>4111111111111111 </td><td>04/12 </td><td>123 Test St. </td><td>Somewhere </td><td>CA </td><td>90001 </td><td>123 </td></tr>
		<tr><td>MasterCard </td><td>5411111111111115 </td><td>04/12 </td><td>4000 Main St. </td><td>Anytown </td><td>AZ </td><td>85001 </td><td>777 </td></tr>
		<tr><td>American Express </td><td>341111111111111 </td><td>04/12 </td><td>12 Colorado Blvd. </td><td>Elsewhere </td><td>IL </td><td>54321 </td><td>4000 </td></tr>
		<tr><td>Discover </td><td>6011111111111117 </td><td>04/12 </td><td>6789 Green Ave. </td><td>Nowhere </td><td>MA </td><td>12345 </td><td>- </td></tr>
		<tr><td>Diner's Club </td><td>36484444444446 </td><td>04/12 </td><td>7390 Del Mar Blvd. </td><td>Atown </td><td>NY </td><td>01101 </td><td>- </td></tr>
		<tr><td>JCB </td><td>213122222222221 </td><td>04/12 </td><td>350 Madison Ave. </td><td>Springfield </td><td>OH </td><td>400000 </td><td>- </td></tr>
	</tbody></table>
</center>

<p>
The following card numbers will generate a decline, with the
declinetype listed as follows. You may use this to test code which
takes different paths dependent upon the type of decline. </p><h3 align="center">Test Cards - Declined </h3>

<center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Card Number </th><th>Exp </th><th>DeclineType </th></tr>
		<tr><td>4012345678909 </td><td>04/12 </td><td>decline </td></tr>
		<tr><td>5555444433332226 </td><td>04/12 </td><td>call </td></tr>
		<tr><td>4444111144441111 </td><td>04/12 </td><td>carderror </td></tr>
	</tbody></table>
</center>

<p>

</p><h3 align="center">ACH Test Numbers </h3>

<center>
	<table bgcolor="#e0e0e0" border="1" cellpadding="5" cellspacing="2">
		<tbody><tr><th>Routing Number </th><th>Account Number </th></tr>
		<tr><td>789456124 </td><td>55544433221 </td></tr>
	</tbody></table>
</center>

<p>
You should also test your code to make sure it properly handles all <a href="#Bad%20Data%7Coutline">baddata </a>and <a href="#Errortype%7Coutline">error </a>cases. Simply pass bad values in order to generate these situations. 

</p><h2><a name="troubleshooting"></a>Appendix B - Troubleshooting </h2>

<p>
Details about installing and troubleshooting TCLink specific to your
development platform can be found in the documentation included with
the TCLink archive. </p><p>
Once you are able to connect to the TC gateway, you should be able to diagnose parameter-related issues using the <a href="#Status%7Coutline">status</a>, <a href="#Decline%20Type%7Coutline">declinetype </a>, and <a href="#Errortype%7Coutline">errortype </a>parameters returned by the gateway. There is one response which indicates a more generic error, and that's an error of <b>cantconnect</b>. First, check the computer's network connection; can you ping machines on the Internet, by IP or by name?  

</p><p>
The most common network connectivity error is that your target computer
may be behind a firewall. TCLink uses the HTTPS port (443/tcp) for
network communications; you can check whether this port is open from
the target machine by typing "telnet vault.trustcommerce.com 443" at a
UNIX command prompt, or else by loading a web browser on the target
machine and attempting to visit https://vault.trustcommerce.com
directly. If you timeout attempting to make the connection, but your
Internet connection is working otherwise, then you may be firewalled.
Speak to your network administrator about allowing outbound TCP traffic
on port 443. </p><p>
Another common problem is the lack of domain name (DNS) resolution. In some cases this will result in an errortype <b>dnsfailure</b>.
(Not always; the TCLink software will sometimes fall back to hard coded
IP addresses for established accounts. But this method is insecure and
error-prone, and is used only as a last resort to keep a system with
temporary DNS issues up and running during the outage.) The target
machine must be able to resolve the trustcommerce.com domain; try
typing "host trustcommerce.com" from a UNIX command prompt. If you
don't get a response, or get an error, then the machine cannot resolve
DNS information and TCLink will not be able to connect to the TC
gateway. Speak to your sysadmin about making domain name resolution
available to your target host. </p><h2><a name="httpspost"></a>Appendix C - Connecting via HTTPS POST </h2>

<p>
This method should only be used if a TCLink client install is not an
option. It does not have the failover capability (and thus the
processing uptime is not guaranteed to be 100%), or some of the
enhanced security features of TCLink. In addition, transactions may be
slightly slower, by an extra half second or so. It does, however
support all other features available through TCLink, including all
parameters and transaction types. </p><p>
This is the URL: 

</p><p>
<a href="https://vault.trustcommerce.com/trans/">https://vault.trustcommerce.com/trans/ </a>

</p><p>
The transaction should be sent as a standard POST, with CGI parameters,
URL encoded. The parameters are otherwise identical to those used
through TCLink. </p><p>
Response parameters are returned as name-value pairs separated by newlines. 

</p><h2><a name="currency"></a>Appendix D - Currency Table </h2>
<h3 align="center">Currency Codes </h3>
	<table align="center" bgcolor="#e0e0e0" border="1" cellpadding="5">
	<tbody><tr><th>Code</th><th>Currency Type</th><th>Code</th><th>Currency Type</th></tr>
	<tr><td>usd</td><td>US Dollars</td><td>jpy</td><td>Japan Yen</td></tr>
	<tr><td>eur</td><td>Euro</td><td>jod</td><td>Jordan Dinar</td></tr>

	<tr><td>cad</td><td>Canadian Dollars</td><td>krw</td><td>Korea (South) Won</td></tr>
	<tr><td>gbp</td><td>UK Pounds</td><td>lbp</td><td>Lebanon Pounds</td></tr>
	<tr><td>dem</td><td>German Deutschemarks</td><td>luf</td><td>Luxembourg Francs</td></tr>

	<tr><td>frf</td><td>French Francs</td><td>myr</td><td>Malaysia Ringgit</td></tr>
	<tr><td>jpy</td><td>Japanese Yen</td><td>mxp</td><td>Mexico Pesos</td></tr>
	<tr><td>nlg</td><td>Dutch Guilders</td><td>nlg</td><td>Netherlands Guilders</td></tr>

	<tr><td>itl</td><td>Italian Lira</td><td>nzd</td><td>New Zealand Dollars</td></tr>
	<tr><td>chf</td><td>Switzerland Francs</td><td>nok</td><td>Norway Kroner</td></tr>
	<tr><td>dzd</td><td>Algeria Dinars</td><td>pkr</td><td>Pakistan Rupees</td></tr>

	<tr><td>arp</td><td>Argentina Pesos</td><td>xpd</td><td>Palladium Ounces</td></tr>
	<tr><td>aud</td><td>Australia Dollars</td><td>php</td><td>Philippines Pesos</td></tr>
	<tr><td>ats</td><td>Austria Schillings</td><td>xpt</td><td>Platinum Ounces</td></tr>

	<tr><td>bsd</td><td>Bahamas Dollars</td><td>plz</td><td>Poland Zloty</td></tr>
	<tr><td>bbd</td><td>Barbados Dollars</td><td>pte</td><td>Portugal Escudo</td></tr>
	<tr><td>bef</td><td>Belgium Francs</td><td>rol</td><td>Romania Leu</td></tr>

	<tr><td>bmd</td><td>Bermuda Dollars</td><td>rur</td><td>Russia Rubles</td></tr>
	<tr><td>brr</td><td>Brazil Real</td><td>sar</td><td>Saudi Arabia Riyal</td></tr>
	<tr><td>bgl</td><td>Bulgaria Lev</td><td>xag</td><td>Silver Ounces</td></tr>

	<tr><td>cad</td><td>Canada Dollars</td><td>sgd</td><td>Singapore Dollars</td></tr>
	<tr><td>clp</td><td>Chile Pesos</td><td>skk</td><td>Slovakia Koruna</td></tr>
	<tr><td>cny</td><td>China Yuan Renmimbi</td><td>zar</td><td>South Africa Rand</td></tr>

	<tr><td>cyp</td><td>Cyprus Pounds</td><td>krw</td><td>South Korea Won</td></tr>
	<tr><td>csk</td><td>Czech Republic Koruna</td><td>esp</td><td>Spain Pesetas</td></tr>
	<tr><td>dkk</td><td>Denmark Kroner</td><td>xdr</td><td>Special Drawing Right (IMF)</td></tr>

	<tr><td>nlg</td><td>Dutch Guilders</td><td>sdd</td><td>Sudan Dinar</td></tr>
	<tr><td>xcd</td><td>Eastern Caribbean Dollars</td><td>sek</td><td>Sweden Krona</td></tr>
	<tr><td>egp</td><td>Egypt Pounds</td><td>chf</td><td>Switzerland Francs</td></tr>

	<tr><td>eur</td><td>Euro</td><td>twd</td><td>Taiwan Dollars</td></tr>
	<tr><td>fjd</td><td>Fiji Dollars</td><td>thb</td><td>Thailand Baht</td></tr>
	<tr><td>fim</td><td>Finland Markka</td><td>ttd</td><td>Trinidad and Tobago Dollars</td></tr>

	<tr><td>frf</td><td>France Francs</td><td>trl</td><td>Turkey Lira</td></tr>
	<tr><td>dem</td><td>Germany Deutsche Marks</td><td>gbp</td><td>United Kingdom Pounds</td></tr>
	<tr><td>xau</td><td>Gold Ounces</td><td>usd</td><td>United States Dollars</td></tr>

	<tr><td>grd</td><td>Greece Drachmas</td><td>veb</td><td>Venezuela Bolivar</td></tr>
	<tr><td>hkd</td><td>Hong Kong Dollars</td><td>zmk</td><td>Zambia Kwacha</td></tr>
	<tr><td>huf</td><td>Hungary Forint</td><td>eur</td><td>Euro</td></tr>

	<tr><td>isk</td><td>Iceland Krona</td><td>xcd</td><td>Eastern Caribbean Dollars</td></tr>
	<tr><td>inr</td><td>India Rupees</td><td>xdr</td><td>Special Drawing Right (IMF)</td></tr>
	<tr><td>idr</td><td>Indonesia Rupiah</td><td>xag</td><td>Silver Ounces</td></tr>

	<tr><td>iep</td><td>Ireland Punt</td><td>xau</td><td>Gold Ounces</td></tr>
	<tr><td>ils</td><td>Israel New Shekels</td><td>xpd</td><td>Palladium Ounces</td></tr>
	<tr><td>itl</td><td>Italy Lira</td><td>xpt</td><td>Platinum Ounces</td></tr>

	<tr><td>jmd</td><td>Jamaica Dollars</td><td>&nbsp;</td><td>&nbsp;</td></tr>
	</tbody></table>
<p>

<a name="inputfields"></a></p><h2>Appendix E - Input Field List</h2>

	<center><h3>Input Fields</h3></center>
	<table align="center" bgcolor="#e0e0e0" border="1" cellpadding="5">
		<tbody><tr><th>Name</th><th>Type</th><th>Minimum Length</th><th>Maximum Length</th><th>Service</th></tr>

			<tr><td>custid</td><td>string</td><td>1</td><td>20</td><td><br></td></tr>
			<tr><td>password</td><td>string</td><td>1</td><td>20</td><td><br></td></tr>
			<tr><td>action</td><td>string</td><td>1</td><td>10</td><td><br></td></tr>

			<tr><td>media</td><td>string</td><td>1</td><td>10</td><td><br></td></tr>
			<tr><td>currency</td><td>string</td><td>3</td><td>3</td><td><br></td></tr>
			<tr><td>amount</td><td>number</td><td>3</td><td>8</td><td><br></td></tr>

			<tr><td>cc</td><td>number</td><td>13</td><td>16</td><td><br></td></tr>
			<tr><td>exp</td><td>number</td><td>4</td><td>4</td><td><br></td></tr>
			<tr><td>cvv</td><td>number</td><td>3</td><td>4</td><td><br></td></tr>

			<tr><td>routing</td><td>number</td><td>9</td><td>9</td><td>ACH</td></tr>
			<tr><td>account</td><td>number</td><td>3</td><td>17</td><td>ACH</td></tr>
			<tr><td>billingid</td><td>string</td><td>6</td><td>6</td><td>Citadel</td></tr>

			<tr><td>verify</td><td>y/n</td><td>1</td><td>1</td><td>Citadel</td></tr>
			<tr><td>transid</td><td>string</td><td>14</td><td>14</td><td><br></td></tr>
			<tr><td>avs</td><td>y/n</td><td>1</td><td>10</td><td><br></td></tr>

			<tr><td>name</td><td>string</td><td>1</td><td>60</td><td><br></td></tr>
			<tr><td>address1</td><td>string</td><td>1</td><td>80</td><td><br></td></tr>
			<tr><td>address2</td><td>string</td><td>1</td><td>80</td><td><br></td></tr>

			<tr><td>zip</td><td>string</td><td>1</td><td>20</td><td><br></td></tr>
			<tr><td>city</td><td>string</td><td>1</td><td>40</td><td><br></td></tr>
			<tr><td>state</td><td>string</td><td>1</td><td>20</td><td><br></td></tr>

			<tr><td>country</td><td>string</td><td>1</td><td>20</td><td><br></td></tr>
			<tr><td>phone</td><td>string</td><td>1</td><td>30</td><td><br></td></tr>
			<tr><td>email</td><td>string</td><td>1</td><td>50</td><td><br></td></tr>
			<tr><td>ip</td><td>string</td><td>7</td><td>15</td><td><br></td></tr>

			<tr><td>track1</td><td>string</td><td>1</td><td>79</td><td>Card Swipe</td></tr>
			<tr><td>track2</td><td>string</td><td>1</td><td>40</td><td>Card Swipe</td></tr>
			<tr><td>ticket</td><td>string</td><td>1</td><td>30</td><td><br></td></tr>

			<tr><td>operator</td><td>string</td><td>1</td><td>20</td><td><br></td></tr>
			<tr><td>shiptosame</td><td>y/n</td><td>1</td><td>1</td><td><br></td></tr>
			<tr><td>shipto_name</td><td>string</td><td>1</td><td>60</td><td><br></td></tr>

			<tr><td>shipto_address1</td><td>string</td><td>1</td><td>40</td><td><br></td></tr>
			<tr><td>shipto_address2</td><td>string</td><td>1</td><td>20</td><td><br></td></tr>
			<tr><td>shipto_city</td><td>string</td><td>1</td><td>20</td><td><br></td></tr>

			<tr><td>shipto_state</td><td>string</td><td>2</td><td>2</td><td><br></td></tr>
			<tr><td>shipto_zip</td><td>string</td><td>1</td><td>20</td><td><br></td></tr>
			<tr><td>shipto_country</td><td>string</td><td>1</td><td>20</td><td><br></td></tr>

			<tr><td>numitems</td><td>number</td><td>1</td><td>3</td><td><br></td></tr>
			<tr><td>price</td><td>string</td><td>1</td><td>20</td><td><br></td></tr>
			<tr><td>shippingcode</td><td>string</td><td>1</td><td>20</td><td><br></td></tr>

			<tr><td>shippinghandling</td><td>string</td><td>1</td><td>20</td><td><br></td></tr>
			<tr><td>productcode#</td><td>string</td><td>1</td><td>20</td><td><br></td></tr>
			<tr><td>quantity#</td><td>number</td><td>1</td><td>3</td><td><br></td></tr>

			<tr><td>price#</td><td>number</td><td>1</td><td>6</td><td><br></td></tr>
			<tr><td>tax#</td><td>number</td><td>1</td><td>6</td><td><br></td></tr>
			<tr><td>shippinghandling#</td><td>number</td><td>1</td><td>6</td><td><br></td></tr>

			<tr><td>wallet</td><td>y/n</td><td>1</td><td>1</td><td>TC Wallet</td></tr>
			<tr><td>walletsize</td><td>string</td><td>3</td><td>8</td><td>TC Wallet</td></tr>
			<tr><td>walletexposure</td><td>string</td><td>1</td><td>3</td><td>TC Wallet</td></tr>

			<tr><td>start</td><td>string</td><td>2</td><td>10</td><td>Citadel</td></tr>
			<tr><td>cycle</td><td>string</td><td>2</td><td>4</td><td>Citadel</td></tr>
			<tr><td>payments</td><td>number</td><td>1</td><td>4</td><td>Citadel</td></tr>
			<tr><td>authnow</td><td>y/n</td><td>1</td><td>1</td><td>Citadel</td></tr>
			<tr><td>lastpaymentunstore</td><td>y/n</td><td>1</td><td>1</td><td>Citadel</td></tr>

			<tr><td>fraudthreshold</td><td>number</td><td>1</td><td>2</td><td>CrediGuard (Scoring)</td></tr>
			<tr><td>ip</td><td>number</td><td>7</td><td>15</td><td>CrediGuard (Blacklist)</td></tr>

			<tr><td>demo</td><td>y/n</td><td>1</td><td>1</td><td><br></td></tr>
			<tr><td>offlineauthcode</td><td>string</td><td>6</td><td>6</td><td><br></td></tr>
	</tbody></table><center>

<p style="margin-left: 1.18in; margin-bottom: 0in;" align="center"><i>Copyright
 2006 TrustCommerce</i> 


</p></center></body></html>
